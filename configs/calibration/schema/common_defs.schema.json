{
  "$id": "https://spectramind.v50/schema/calibration/common_defs.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$vocabulary": {
    "https://json-schema.org/draft/2020-12/vocab/core": true,
    "https://json-schema.org/draft/2020-12/vocab/applicator": true,
    "https://json-schema.org/draft/2020-12/vocab/validation": true
  },
  "$anchor": "common_defs",
  "title": "Common Definitions for Calibration Schemas",
  "type": "object",
  "$defs": {
    "enabled": {
      "type": "object",
      "properties": { "enabled": { "type": "boolean", "default": true } },
      "required": ["enabled"],
      "additionalProperties": true
    },
    "path": {
      "type": "string",
      "minLength": 1,
      "description": "Filesystem path (relative to repo root unless absolute)."
    },
    "rng": {
      "type": "object",
      "properties": {
        "seed": { "type": "integer", "minimum": 0, "maximum": 4294967295 }
      },
      "additionalProperties": false
    },
    "bounds_pair": {
      "type": "array",
      "prefixItems": [
        { "type": "number" },
        { "type": "number" }
      ],
      "minItems": 2,
      "maxItems": 2
    },
    "range_pair_int": {
      "type": "array",
      "prefixItems": [
        { "type": "integer" },
        { "type": "integer" }
      ],
      "minItems": 2,
      "maxItems": 2
    },
    "center_xy": {
      "type": "array",
      "prefixItems": [
        { "type": "number" },
        { "type": "number" }
      ],
      "minItems": 2,
      "maxItems": 2,
      "description": "2D center [x, y] in pixels."
    },
    "enum_normalize": {
      "enum": ["mean", "median", "zscore", "mad", "none"]
    },
    "enum_trace_model": {
      "enum": ["poly1", "poly2", "poly3", "spline"]
    },
    "enum_detectors": {
      "enum": ["FGS1", "AIRS"]
    },
    "enum_regressor": {
      "enum": ["jitter_x", "jitter_y", "centroid_x", "centroid_y", "airmass", "sky_bg", "temp_det", "time"]
    },
    "regularization": {
      "type": "object",
      "properties": {
        "method": { "enum": ["none", "l2", "l1", "ridge", "lasso", "elasticnet"] },
        "alpha": { "type": "number", "minimum": 0.0 }
      },
      "additionalProperties": false
    },
    "polynomial_coeffs": {
      "type": "array",
      "minItems": 1,
      "items": { "type": "number" },
      "description": "Polynomial coefficients in increasing order (c0, c1, â€¦ ck)."
    },
    "spline_knots": {
      "type": "array",
      "minItems": 2,
      "items": { "type": "number" },
      "description": "Spline knot locations in pixel or wavelength units."
    },
    "percent_0_1": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0
    },
    "positive_number": {
      "type": "number",
      "exclusiveMinimum": 0.0
    },
    "non_negative_number": {
      "type": "number",
      "minimum": 0.0
    },
    "non_negative_integer": {
      "type": "integer",
      "minimum": 0
    },
    "threads": {
      "type": "integer",
      "minimum": 1,
      "maximum": 65536
    }
  }
}
